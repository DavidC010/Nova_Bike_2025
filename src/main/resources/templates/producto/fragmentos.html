<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
    <head th:fragment="head">
        <title>Nova Bikes Shop</title>
        <meta charset="UTF-8"/>
        <link th:href="@{/webjars/bootstrap/css/bootstrap.min.css}" rel="stylesheet"/>
        <link th:href="@{/webjars/font-awesome/css/all.css}" rel="stylesheet"/>
        <link th:href="@{/css/estilos.css}" rel="stylesheet"/>
        <script th:src="@{/webjars/jquery/jquery.min.js}"></script>
        <script th:src="@{/webjars/popper.js/umd/popper.min.js}"></script>
        <script th:src="@{/webjars/bootstrap/js/bootstrap.min.js}"></script>
    </head>
    <body>
        <!-- Barra de búsqueda -->
        <form th:fragment="tiendaSearchBar"
              th:action="@{/producto/listado}" method="get"
              class="tienda-bar d-flex align-items-center justify-content-between px-4 py-3">
 
            <h2 class="tienda-titulo m-0">TIENDA</h2>
 
            <div class="flex-grow-1 mx-4 position-relative">
                <input type="text" name="q" class="form-control rounded-pill ps-4 pe-5 tienda-input"
                       placeholder="Buscar productos..." th:value="${q}">
                    <button type="submit" class="btn position-absolute top-50 end-0 translate-middle-y me-3 p-0 border-0 bg-transparent">
                        <i class="bi bi-search tienda-icono"></i>
                    </button>
            </div>
 
            <!-- Botón para ver favoritos -->
            <a th:href="@{/producto/listado(favoritos=true)}" class="btn btn-outline-danger rounded-pill px-3">
                Favoritos
            </a>
 
        </form>
 
        <!-- Listado de productos -->
        <section th:fragment="listado" class="container py-4">
            <div class="row text-center mb-4">
                <h2>Listado de Productos</h2>
            </div>
 
            <div class="row">
                <div th:if="${productos != null and !productos.empty}">
                    <div class="row row-cols-1 row-cols-md-3 g-4">
                        <div class="col" th:each="p : ${productos}">
                            <div class="card h-100 shadow-sm">
                                <img th:src="${p.rutaImagen}" class="card-img-top" alt="Imagen del producto" style="height: 200px; object-fit: cover;">
                                    <div class="card-body">
                                        <h5 class="card-title" th:text="${p.nombre}">Nombre del producto</h5>
                                        <p class="card-text text-muted" th:text="${p.descripcion}">Descripción del producto</p>
                                        <p class="fw-bold text-primary" th:text="'₡' + ${#numbers.formatDecimal(p.precio, 0, 'POINT', 2, 'COMMA')}"></p>
 
                                        <!-- Botón para marcar como favorito -->
                                        <form th:action="@{/producto/favorito/{id}(id=${p.id})}" method="post">
                                            <button type="submit" class="btn btn-outline-danger btn-sm">
                                                Marcar favorito
                                            </button>
                                        </form>
                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
 
                <div class="text-center p-3" th:if="${productos == null or productos.empty}">
                    <span>No hay productos disponibles en este momento.</span>
                </div>
            </div>
        </section>
    </body>
</html>